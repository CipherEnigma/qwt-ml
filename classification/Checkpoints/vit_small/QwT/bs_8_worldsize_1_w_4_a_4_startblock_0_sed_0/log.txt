Training with a single process on 1 GPUs.
Namespace(model='vit_small', data_dir='/content/QwT/imagenet1k', w_bits=4, a_bits=4, start_block=0, batch_size=8, num_workers=4, seed=0, local_rank=0, drop_path=0.0, num_classes=1000, distributed=False, device='cuda:0', world_size=1, rank=0, log_dir='checkpoint/vit_small/QwT/bs_8_worldsize_1_w_4_a_4_startblock_0_sed_0', log_file='checkpoint/vit_small/QwT/bs_8_worldsize_1_w_4_a_4_startblock_0_sed_0/log.txt')
dataset mean : (0.5, 0.5, 0.5) & std : (0.5, 0.5, 0.5)
len of train_set : 80000    train_transform : Compose(
    RandomResizedCropAndInterpolation(size=(224, 224), scale=(0.08, 1.0), ratio=(0.75, 1.3333), interpolation=PIL.Image.BICUBIC)
    RandomHorizontalFlip(p=0.5)
    <timm.data.auto_augment.RandAugment object at 0xf6ef882af30>
    ToTensor()
    Normalize(mean=(0.5, 0.5, 0.5), std=(0.5, 0.5, 0.5))
)
len of eval_set : 20001    eval_transform : Compose(
    Resize(size=248, interpolation=bicubic, max_size=None, antialias=True)
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=(0.5, 0.5, 0.5), std=(0.5, 0.5, 0.5))
)
sampler : None      shuffle : True
sampler : None      shuffle : False
local_rank : 0 calib_data shape : torch.Size([8, 3, 224, 224]) value : tensor([-0.8902, -0.8824, -0.8745, -0.8667, -0.8510], device='cuda:0')
Building model ...
Performing initial quantization ...
Performing scale reparameterization ...
RepQ-ViT model size is 11.848
Test  Smples : 20001    Acc@1: 63.1918
RepQ-ViT   eval_acc: 63.19
start to generate compensation model
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 0      abs : 0.214532      r2 : 0.188
block 0 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 1      abs : 0.152611      r2 : 0.277
block 1 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 2      abs : 0.127049      r2 : 0.231
block 2 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 3      abs : 0.122020      r2 : 0.297
block 3 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 4      abs : 0.128134      r2 : 0.309
block 4 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 5      abs : 0.128937      r2 : 0.575
block 5 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 6      abs : 0.164174      r2 : 0.926
block 6 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 7      abs : 0.164601      r2 : 0.190
block 7 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 8      abs : 0.211775      r2 : 0.364
block 8 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 9      abs : 0.283806      r2 : 0.170
block 9 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 10      abs : 0.564174      r2 : 0.097
block 10 using linear init
the shape of X_add_one is torch.Size([100864, 385]), Y is torch.Size([100864, 384])
block : 11      abs : 0.344704      r2 : 0.186
block 11 using linear init
RepQ-ViT + QwT model size is 15.405
Test  Smples : 20001    Acc@1: 66.6117
RepQ-ViT + QwT   eval_acc: 66.61
